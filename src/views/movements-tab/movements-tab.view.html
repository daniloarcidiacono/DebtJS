<div class="data-table-container">
    <header class="data-table-header">			    	
        <div class="data-table-header__label">
            <span class="fs-title">
            	Movements
			</span>
        </div>	
        <div class="data-table-header__actions">
			<lx-button lx-type="fab" ng-click="mainCtrl.newDocument(true)" lx-tooltip="New" lx-tooltip-position="bottom">
				<i class="mdi mdi-file"></i>
			</lx-button>	            	
			<lx-button lx-type="fab" ng-click="mainCtrl.addEntry()" lx-tooltip="Add (Ctrl+Enter)" lx-tooltip-position="bottom">
				<i class="mdi mdi-plus"></i>
			</lx-button>	            	
			<lx-button lx-type="fab" ng-disabled="mainCtrl.getSelectedItemsCount() === 0" ng-click="mainCtrl.confirmRemoval()" lx-tooltip="Remove selected" lx-tooltip-position="bottom">
				<i class="mdi mdi-delete"></i>
			</lx-button>
			<lx-button lx-type="fab" ng-click="mainCtrl.exportJson()" lx-tooltip="Export JSON" lx-tooltip-position="bottom" >
				<i class="mdi mdi-download"></i>
			</lx-button>
			
			<lx-button lx-type="fab" ng-click="mainCtrl.importJson()" lx-tooltip="Import JSON" lx-tooltip-position="bottom" >
				<i class="mdi mdi-upload"></i>							
			</lx-button>						
        </div>	 
    </header>
 
    <table class="data-table">
        <thead>
            <tr class="data-table__selectable-row">
                <th></th>
                <th style="text-align: left">Description</th>
                <th style="text-align: left">Amount</th>
                <th style="text-align: left">Quantity</th>
                <th ng-repeat="buyer in mainCtrl.getBuyers()"> {{ buyer.name }}</th>
            </tr>
        </thead>
 
        <tbody>
            <tr class="data-table__selectable-row" 
            	ng-repeat="row in mainCtrl.getData() track by $index" 
            	ng-init="rowIndex = $index"
            	ng-class="{ 'data-table__selectable-row--is-selected': row.isSelected }">
                <td class="rowSelectCell"><lx-checkbox ng-model="row.isSelected"></lx-checkbox></td>
                <td>
                	<lx-text-field lx-label="Description" lx-fixed-label="true">
    				    <input type="text" ng-model="row.description" class="txtDescription mousetrap">
					</lx-text-field>
				</td>
                <td>
                	<lx-text-field lx-label="Amount" lx-fixed-label="true">
    				    <input type="text" ng-model="row.amount" class="mousetrap">
					</lx-text-field>
				</td>
                <td>
                	<lx-text-field lx-label="Quantity" lx-fixed-label="true" class="mousetrap">
    				    <input type="text" ng-model="row.quantity">
					</lx-text-field>
				</td>
				<td ng-repeat="buyer in mainCtrl.getBuyers()">
					<lx-checkbox ng-model="row[buyer.name]">
					</lx-checkbox>
					<span ng-if="buyer !== mainCtrl.getBuyer()" class="smalltext">
						+ {{ mainCtrl.getDebtForRow(rowIndex, buyer) | number:2 }} €
					</span>
					<span ng-if="buyer === mainCtrl.getBuyer()" class="smalltext">
						- {{ mainCtrl.getDebtForRow(rowIndex, buyer) | number:2 }} €
					</span>	        						
            	</td>		
            </tr>
        </tbody>
        <tfoot>
            <tr>
            	<td></td>
            	<td style="text-align: left"><b>Total</b></td>
            	<td style="text-align: left"><b>{{ mainCtrl.getTotalAmount() | number:2 }} €</b></td>
            	<td style="text-align: left"><i>n/a</i></td>
            	<td ng-repeat="buyer in mainCtrl.getBuyers()">
            		<b>
						<span ng-if="buyer.name !== mainCtrl.getBuyer().name" class="earning">
							+ {{ mainCtrl.getDebt(buyer) | number:2 }} €
						</span>
						<span ng-if="buyer.name === mainCtrl.getBuyer().name" class="debt">
							- {{ mainCtrl.getDebt(buyer) | number:2 }} €
						</span>
					</b>
            	</td>
            </tr>
        </tfoot>
    </table>
</div>

<!-- Import dialog -->
<lx-dialog id="importDialog">
    <lx-dialog-header>
        <div class="toolbar bgc-primary pl++">
            <span class="toolbar__label tc-white fs-title">
                Choose a file
            </span>
        </div>
        <lx-progress lx-type="linear" lx-color="teal" ng-if="mainCtrl.showDeterminateLinearProgress" lx-value="{{ mainCtrl.determinateLinearProgressValue }}"></lx-progress>
        <lx-progress lx-type="linear" lx-color="teal" ng-if="mainCtrl.showIndeterminateLinearProgress"></lx-progress>
    </lx-dialog-header>
 
    <lx-dialog-content>
    	<div class="p+ pt0">
    		<lx-file-input lx-label="Browse..." lx-callback="mainCtrl.importJson(newFile)"></lx-file-input>
    	</div>
    </lx-dialog-content>
 
    <lx-dialog-footer>
        <lx-button lx-color="black" lx-type="flat" lx-dialog-close>Cancel</lx-button>
    </lx-dialog-footer>
</lx-dialog>
